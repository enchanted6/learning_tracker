{% extends 'base_for_test.html' %}
{% block title %}å­¦ä¹ èµ„æ–™åº“{% endblock %}

{% block content %}
<main class="content-area">
    <div class="glass-card">
        <!-- 1. æ ‡é¢˜ä¸æ·»åŠ æŒ‰é’® -->
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
            <div>
                <h2 style="margin: 0;">å­¦ä¹ èµ„æ–™ç®¡ç†</h2>
                <p style="color: #888; font-size: 0.9rem; margin-top: 5px;">ç®¡ç†æ‚¨çš„æ–‡æ¡£ã€è§†é¢‘ã€é“¾æ¥ç­‰å„ç§å­¦ä¹ èµ„æº</p>
            </div>
            <a href="{% url 'material_create' %}" class="btn-primary" style="width: auto; padding: 10px 20px;">+ æ·»åŠ å­¦ä¹ èµ„æ–™</a>
        </div>

        <!-- 2. ç­›é€‰åŒºåŸŸ -->
        <div class="filter-section">
            <form method="get" class="filter-form">
                <div class="filter-group">
                    <label>æ‰€å±è¯¾ç¨‹</label>
                    <select name="course">
                        <option value="">å…¨éƒ¨è¯¾ç¨‹</option>
                        {% for course in courses %}
                            {% with course_pk_str=course.pk|stringformat:"s" %}
                                <option value="{{ course.pk }}" {% if request.GET.course == course_pk_str %}selected{% endif %}>
                                {{ course.name }}</option>
                            {% endwith %}
                        {% endfor %}
                    </select>
                </div>
                <div class="filter-group">
                    <label>èµ„æ–™ç±»å‹</label>
                    <select name="material_type">
                        <option value="">å…¨éƒ¨ç±»å‹</option>
                        {% for value, label in material_types %}
                        <option value="{{ value }}" {% if request.GET.material_type == value %}selected{% endif %}>{{ label }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="filter-actions">
                    <button type="submit" class="btn-filter">ç­›é€‰</button>
                    <a href="{% url 'material_list' %}" class="btn-reset">é‡ç½®</a>
                </div>
            </form>
        </div>

        <!-- 3. æ•°æ®è¡¨æ ¼ -->
        <table class="styled-table">
            <thead>
                <tr>
                    <th>èµ„æ–™åç§°</th>
                    <th>æ‰€å±è¯¾ç¨‹</th>
                    <th>ç±»å‹</th>
                    <th style="text-align: center;">é¢„è®¡æ—¶é•¿</th>
                    <th style="text-align: center;">å·²å­¦æ—¶é•¿</th>
                    <th style="text-align: center;">æ“ä½œ</th>
                </tr>
            </thead>
            <tbody>
                {% for material in materials %}
                <tr>
                    <td><strong>{{ material.name }}</strong></td>
                    <td><span class="course-tag">{{ material.course.name }}</span></td>
                    <td><span class="type-badge">{{ material.get_material_type_display }}</span></td>
                    <td style="text-align: center; color: #666;">{{ material.estimated_time }} min</td>
                    <td style="text-align: center;">
                        <span class="study-time {% if material.get_total_study_time > 0 %}active{% endif %}">
                            {{ material.get_total_study_time }} min
                        </span>
                    </td>
                    <td style="text-align: center;">
                        <a href="{% url 'material_update' material.pk %}" class="btn-sm btn-edit">ç¼–è¾‘</a>
                        <a href="{% url 'material_delete' material.pk %}" class="btn-sm btn-del">åˆ é™¤</a>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="6" style="text-align: center; color: #999; padding: 50px;">
                        <div style="font-size: 3rem; margin-bottom: 10px;">ğŸ“‚</div>
                        æš‚æ— å­¦ä¹ èµ„æ–™ï¼Œç‚¹å‡»å³ä¸Šè§’å¼€å§‹æ·»åŠ 
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</main>

<style>
    /* ç­›é€‰å™¨æ ·å¼ */
    .filter-section { background: #fdfdfd; border: 1px solid #f0f0f0; border-radius: 10px; padding: 15px 20px; margin-bottom: 30px; }
    .filter-form { display: flex; align-items: flex-end; gap: 20px; flex-wrap: wrap; }
    .filter-group { display: flex; flex-direction: column; gap: 6px; }
    .filter-group label { font-size: 0.8rem; color: #888; font-weight: 600; }
    .filter-group select {
        padding: 8px 12px; border: 1px solid #ddd; border-radius: 6px;
        background: white; min-width: 160px; outline: none; transition: 0.3s;
    }
    .filter-group select:focus { border-color: #007bff; box-shadow: 0 0 0 2px rgba(0,123,255,0.1); }

    .btn-filter { background: #007bff; color: white; border: none; padding: 9px 25px; border-radius: 6px; cursor: pointer; font-weight: 500; }
    .btn-filter:hover { background: #0056b3; }
    .btn-reset { color: #999; text-decoration: none; font-size: 0.85rem; padding-bottom: 8px; }
    .btn-reset:hover { color: #e74c3c; }

    /* è¡¨æ ¼æ ·å¼ */
    .styled-table { width: 100%; border-collapse: collapse; }
    .styled-table th { text-align: left; padding: 15px 12px; border-bottom: 2px solid #eee; color: #666; font-size: 0.9rem; }
    .styled-table td { padding: 15px 12px; border-bottom: 1px solid #f1f1f1; vertical-align: middle; }
    .styled-table tr:hover { background-color: rgba(0,123,255,0.02); }

    /* æ•°æ®æ ‡ç­¾æ ·å¼ */
    .course-tag { color: #555; background: #f0f0f0; padding: 3px 8px; border-radius: 4px; font-size: 0.85rem; }
    .type-badge { background: #eef2ff; color: #4f46e5; padding: 4px 10px; border-radius: 20px; font-size: 0.8rem; font-weight: 500; }
    .study-time { color: #999; font-weight: 500; }
    .study-time.active { color: #2ecc71; }

    /* æŒ‰é’®é€šç”¨ */
    .btn-primary { background: #007bff; color: white; text-decoration: none; border-radius: 8px; font-weight: bold; transition: 0.3s; }
    .btn-sm { padding: 6px 14px; font-size: 0.8rem; border-radius: 5px; text-decoration: none; display: inline-block; margin: 0 2px; }
    .btn-edit { background: #ffc107; color: #000; }
    .btn-edit:hover { background: #e0a800; }
    .btn-del { background: #fff; color: #dc3545; border: 1px solid #dc3545; }
    .btn-del:hover { background: #dc3545; color: #fff; }
</style>
{% endblock %}