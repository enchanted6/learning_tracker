{% extends 'base.html' %}
{% block title %}仪表板{% endblock %}
{% block content %}
<h2>学习统计仪表板</h2>

<div style="display: flex; gap: 20px; margin: 20px 0;">
    <div style="border: 1px solid #ddd; padding: 15px; border-radius: 5px;">
        <h3>总学习记录</h3>
        <p style="font-size: 24px;">{{ total_sessions }}</p>
    </div>
    <div style="border: 1px solid #ddd; padding: 15px; border-radius: 5px;">
        <h3>总学习时长</h3>
        <p style="font-size: 24px;">{{ total_time_hours }} 小时</p>
    </div>
    <div style="border: 1px solid #ddd; padding: 15px; border-radius: 5px;">
        <h3>今日学习</h3>
        <p style="font-size: 24px;">{{ today_time_hours }} 小时</p>
    </div>
</div>

{% if trend_chart %}
<div style="margin: 20px 0;">
    <h3>学习时长趋势（最近30天）</h3>
    <img src="{{ trend_chart }}" alt="学习时长趋势图" style="max-width: 100%;">
</div>
{% endif %}

{% if distribution_chart %}
<div style="margin: 20px 0;">
    <h3>课程时间分布</h3>
    <img src="{{ distribution_chart }}" alt="课程时间分布图" style="max-width: 100%;">
</div>
{% endif %}

<h3>课程统计（Top 5）</h3>
<table border="1" style="width:100%; border-collapse:collapse;">
    <tr>
        <th>课程名称</th>
        <th>总学习时长（分钟）</th>
    </tr>
    {% for course in course_stats %}
    <tr>
        <td>{{ course.name }}</td>
        <td>{{ course.total_time|default:0|floatformat:1 }}</td>
    </tr>
    {% empty %}
    <tr><td colspan="2">暂无数据</td></tr>
    {% endfor %}
</table>
{% endblock %}

