{% extends 'base_for_test.html' %}
{% block title %}ä»ªè¡¨ç›˜{% endblock %}
{% block content %}
    <main class="content-area">
        <div class="dashboard-header">
            <h2>å­¦ä¹ ç»Ÿè®¡ä»ªè¡¨æ¿</h2>
            <p class="subtitle">æ¬¢è¿å›æ¥ï¼è¿™æ˜¯ä½ ç›®å‰çš„å­¦ä¹ è¿›åº¦æ¦‚è§ˆ</p>
        </div>

        <!-- ç»Ÿè®¡æ•°å­—å¡ç‰‡ -->
        <div class="stats-grid">
            <div class="glass-card stat-card blue">
                <div class="stat-icon">ğŸ•’</div>
                <div class="stat-info">
                    <h3>æ€»å­¦ä¹ è®°å½•</h3>
                    <div class="stat-value">{{ total_sessions }} <span class="unit">æ¡</span></div>
                </div>
            </div>
            <div class="glass-card stat-card green">
                <div class="stat-icon">âŒ›</div>
                <div class="stat-info">
                    <h3>æ€»å­¦ä¹ æ—¶é•¿</h3>
                    <div class="stat-value">{{ total_time_hours }} <span class="unit">å°æ—¶</span></div>
                </div>
            </div>
            <div class="glass-card stat-card orange">
                <div class="stat-icon">ğŸ”¥</div>
                <div class="stat-info">
                    <h3>ä»Šæ—¥å­¦ä¹ </h3>
                    <div class="stat-value">{{ today_time_hours }} <span class="unit">å°æ—¶</span></div>
                </div>
            </div>
        </div>

        <!-- å›¾è¡¨åŒºåŸŸ -->
        <div class="charts-container">
            {% if trend_chart %}
            <div class="glass-card chart-box">
                <div class="card-title">ğŸ“ˆ å­¦ä¹ æ—¶é•¿è¶‹åŠ¿ï¼ˆæœ€è¿‘30å¤©ï¼‰</div>
                <div class="img-wrapper">
                    <img src="{{ trend_chart }}" alt="å­¦ä¹ æ—¶é•¿è¶‹åŠ¿å›¾">
                </div>
            </div>
            {% endif %}

            {% if distribution_chart %}
            <div class="glass-card chart-box">
                <div class="card-title">ğŸ¥§ è¯¾ç¨‹æ—¶é—´åˆ†å¸ƒ</div>
                <div class="img-wrapper">
                    <img src="{{ distribution_chart }}" alt="è¯¾ç¨‹æ—¶é—´åˆ†å¸ƒå›¾">
                </div>
            </div>
            {% endif %}
        </div>

        <!-- è¯¾ç¨‹ç»Ÿè®¡è¡¨æ ¼ -->
        <div class="glass-card table-section">
            <div class="card-title">ğŸ† è¯¾ç¨‹ç»Ÿè®¡ï¼ˆTop 5ï¼‰</div>
            <table class="styled-table">
                <thead>
                    <tr>
                        <th>è¯¾ç¨‹åç§°</th>
                        <th style="text-align: right;">æ€»å­¦ä¹ æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰</th>
                    </tr>
                </thead>
                <tbody>
                    {% for course in course_stats %}
                    <tr>
                        <td><strong>{{ course.name }}</strong></td>
                        <td style="text-align: right;" class="time-col">{{ course.total_time|default:0|floatformat:1 }} min</td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="2" style="text-align: center; color: #999; padding: 30px;">æš‚æ— æ•°æ®ï¼Œå¿«å»å¼€å§‹å­¦ä¹ å§ï¼</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </main>

<style>
    /* å¤´éƒ¨ */
    .dashboard-header { margin-bottom: 30px; }
    .dashboard-header h2 { font-size: 1.8rem; color: #2d3436; margin-bottom: 5px; }
    .subtitle { color: #888; font-size: 0.95rem; }

    /* ç»Ÿè®¡å¡ç‰‡å¸ƒå±€ */
    .stats-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 30px; }
    .stat-card { display: flex; align-items: center; gap: 15px; transition: transform 0.3s; }
    .stat-card:hover { transform: translateY(-5px); }
    .stat-icon { font-size: 2.5rem; }
    .stat-info h3 { font-size: 0.9rem; color: #666; margin-bottom: 5px; }
    .stat-value { font-size: 1.5rem; font-weight: 800; color: #2d3436; }
    .unit { font-size: 0.8rem; font-weight: normal; color: #999; }

    /* å¡ç‰‡ä¸»é¢˜è‰² */
    .stat-card.blue { border-left: 5px solid #007bff; }
    .stat-card.green { border-left: 5px solid #2ecc71; }
    .stat-card.orange { border-left: 5px solid #e67e22; }

    /* å›¾è¡¨åŒºåŸŸå¸ƒå±€ */
    .charts-container { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; }
    .card-title { font-weight: bold; color: #2d3436; margin-bottom: 15px; display: flex; align-items: center; gap: 8px; }
    .img-wrapper { width: 100%; border-radius: 8px; overflow: hidden; background: #fff; }
    .img-wrapper img { width: 100%; height: auto; display: block; }

    /* è¡¨æ ¼æ ·å¼ */
    .table-section { margin-top: 10px; }
    .styled-table { width: 100%; border-collapse: collapse; }
    .styled-table th { background: #f9fafb; padding: 12px; text-align: left; color: #666; font-size: 0.9rem; border-bottom: 2px solid #eee; }
    .styled-table td { padding: 15px 12px; border-bottom: 1px solid #f1f1f1; color: #444; }
    .styled-table tr:hover { background-color: rgba(0,123,255,0.02); }
    .time-col { color: #007bff; font-weight: bold; }

    @media (max-width: 1100px) {
        .charts-container { grid-template-columns: 1fr; }
        .stats-grid { grid-template-columns: 1fr; }
    }
</style>
{% endblock %}