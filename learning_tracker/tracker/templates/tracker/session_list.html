{% extends 'base.html' %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h2>ğŸ“‹ å­¦ä¹ è®°å½•</h2>
    <a href="{% url 'session_create' %}" class="btn btn-success">
        + æ–°å¢è®°å½•
    </a>
</div>

<!-- ç­›é€‰å¡ç‰‡ -->
<div class="card mb-4">
    <div class="card-body bg-light">
        <form method="get" class="row g-3">
            <div class="col-md-3">
                <select name="course" class="form-select">
                    <option value="">-- æ‰€æœ‰è¯¾ç¨‹ --</option>
                    {% for course in courses %}
                    <option value="{{ course.id }}" {% if request.GET.course == course.id|stringformat:"s" %} selected {% endif %} >
                        {{ course.name }}
                    </option>
                    {% endfor %}
                </select>
            </div>
            <div class="col-md-3">
                <input type="date" name="date_start" class="form-control" placeholder="å¼€å§‹æ—¥æœŸ" value="{{ request.GET.date_start }}">
            </div>
            <div class="col-md-3">
                <input type="date" name="date_end" class="form-control" placeholder="ç»“æŸæ—¥æœŸ" value="{{ request.GET.date_end }}">
            </div>
            <div class="col-md-3">
                <button type="submit" class="btn btn-primary w-100">ç­›é€‰</button>
            </div>
        </form>
    </div>
</div>

<!-- æ•°æ®è¡¨æ ¼ -->
<div class="table-responsive">
    <table class="table table-hover table-bordered">
        <thead class="table-light">
            <tr>
                <th>è¯¾ç¨‹</th>
                <th>å¼€å§‹æ—¶é—´</th>
                <th>æ—¶é•¿ (å°æ—¶)</th>
                <th>å¤‡æ³¨</th>
                <th>æ“ä½œ</th>
            </tr>
        </thead>
        <tbody>
            {% for session in sessions %}
            <tr>
                <td>
                    <span class="badge" style="background-color: {{ session.course.color|default:'#6c757d' }}">
                        {{ session.course.name }}
                    </span>
                </td>
                <td>{{ session.start_time|date:"Y-m-d H:i" }}</td>
                <td><strong>{{ session.duration }} h</strong></td>
                <td>{{ session.notes|truncatechars:30 }}</td>
                <td>
                    <a href="{% url 'session_update' session.pk %}" class="btn btn-sm btn-outline-primary">ç¼–è¾‘</a>
                    <a href="{% url 'session_delete' session.pk %}" class="btn btn-sm btn-outline-danger">åˆ é™¤</a>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="5" class="text-center py-4 text-muted">æš‚æ— å­¦ä¹ è®°å½•ï¼Œå¿«å»æ·»åŠ ä¸€æ¡å§ï¼</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}